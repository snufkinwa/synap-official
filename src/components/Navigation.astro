---
interface Props {
  activePage?: 'docs' | 'blog';
}

const { activePage } = Astro.props;
---

<!-- Navigation -->
<div class="w-full h-12 sm:h-14 md:h-16 lg:h-[84px] flex justify-center items-center z-50 px-6 sm:px-8 md:px-12 lg:px-0 relative">
  <div class="w-full h-0 absolute left-0 top-6 sm:top-7 md:top-8 lg:top-[42px] border-t border-[rgba(55,50,47,0.12)] shadow-[0px_1px_0px_white]"></div>

  <div class="w-full max-w-[calc(100%-32px)] sm:max-w-[calc(100%-48px)] md:max-w-[calc(100%-64px)] lg:max-w-[700px] lg:w-[700px] h-10 sm:h-11 md:h-[52px] lg:h-14 py-1.5 sm:py-2 md:py-2.5 lg:py-3 px-3 sm:px-4 md:px-5 lg:px-6 pr-2 sm:pr-3 md:pr-3 lg:pr-3 bg-stone-50 backdrop-blur-sm shadow-[0px_0px_0px_2px_white] overflow-hidden rounded-[50px] flex justify-between items-center relative z-30">
    <div class="flex justify-center items-center">
      <a href="/" class="flex justify-start items-center hover:opacity-80 transition-opacity">
        <img 
          src="/synaptik-logo.png" 
          alt="Synaptik Core" 
          class="w-6 h-6 sm:w-7 sm:h-7 md:w-9 md:h-9 lg:w-10 lg:h-10 object-contain"
        />
      </a>
      <div class="pl-3 sm:pl-4 md:pl-6 lg:pl-6 flex justify-start items-start hidden sm:flex flex-row gap-2 sm:gap-3 md:gap-5 lg:gap-6">
        <a href="/blog" class="flex justify-start items-center hover:opacity-80 transition-opacity">
          <div class="flex flex-col justify-center text-[rgba(49,45,43,0.80)] text-xs md:text-[15px] lg:text-base font-medium leading-[14px] md:leading-[18px] lg:leading-5 font-sans">
            Blog
          </div>
        </a>
        <a href="mailto:janayharris@synaptik-core.dev" class="flex justify-start items-center hover:opacity-80 transition-opacity">
          <div class="flex flex-col justify-center text-[rgba(49,45,43,0.80)] text-xs md:text-[15px] lg:text-base font-medium leading-[14px] md:leading-[18px] lg:leading-5 font-sans">
            Contact
          </div>
        </a>
      </div>
    </div>
    <div class="h-6 sm:h-7 md:h-9 lg:h-10 flex justify-start items-start gap-2 sm:gap-3">
      <!-- Mobile menu button -->
      <button id="mobile-menu-toggle" class="sm:hidden inline-flex items-center justify-center p-1 rounded-md text-neutral-900 hover:bg-neutral-900/5" aria-label="Open menu">
        <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
      <!-- Waitlist button - hidden on mobile, visible on sm and up -->
      <a href="/#waitlist" class="hidden sm:flex px-2 sm:px-3 md:px-4 lg:px-5 py-1 sm:py-[6px] md:py-2 lg:py-2.5 bg-white shadow-[0px_1px_2px_rgba(55,50,47,0.12)] overflow-hidden rounded-full justify-center items-center hover:bg-neutral-50 transition-colors">
        <div class="flex flex-col justify-center text-[#37322F] text-xs md:text-[15px] lg:text-base font-medium leading-5 font-sans">
          Demo
        </div>
      </a>
    </div>
  </div>
</div>

<script>
  (function(){
    // Create and append mobile menu to body
    const mobileMenu = document.createElement('div');
    mobileMenu.id = 'mobile-menu';
    mobileMenu.className = 'fixed inset-0 z-[9999] hidden bg-stone-50 sm:hidden overflow-y-auto';
    mobileMenu.innerHTML = `
      <div class="px-4 pt-6 pb-4 flex items-center justify-between border-b border-neutral-900/6 sticky top-0 bg-stone-50 z-[10000]">
        <a href="/" class="flex items-center">
          <img src="/synaptik-logo.png" alt="Synaptik Core" class="w-8 h-8" />
        </a>
        <button id="mobile-menu-close" class="rounded-full p-2 hover:bg-neutral-900/5" aria-label="Close menu">
          <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <nav class="px-6 py-6 space-y-6">
        <ul class="space-y-4">
          <li><a href="/blog" class="block text-lg font-medium text-neutral-900 hover:text-neutral-900/80">Blog</a></li>
          <li><a href="mailto:janayharris@synaptik-core.dev" class="block text-lg font-medium text-neutral-900 hover:text-neutral-900/80">Contact</a></li>
      <li><a href="/#waitlist" class="block text-lg font-medium text-white bg-neutral-900 px-4 py-2 rounded-full hover:bg-neutral-800 transition-colors text-center">Waitlist</a></li>
        </ul>
      </nav>
    `;
    document.body.appendChild(mobileMenu);
    
    const openBtn = document.getElementById('mobile-menu-toggle');
    const menu = document.getElementById('mobile-menu');
    if (!openBtn || !menu) return;
    
    const toggleMenu = (shouldOpen: boolean) => {
      if (shouldOpen) {
        menu.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      } else {
        menu.classList.add('hidden');
        document.body.style.overflow = '';
      }
    };

    openBtn.addEventListener('click', () => toggleMenu(true));
    
    // Close button handler (needs to be attached after menu is created)
    setTimeout(() => {
      const closeBtn = document.getElementById('mobile-menu-close');
      if (closeBtn) closeBtn.addEventListener('click', () => toggleMenu(false));
    }, 0);
    
    // close when clicking a link
    menu.addEventListener('click', (e) => {
      const target = e.target;
      if (target && target instanceof Element && target.closest('a')) {
        menu.classList.add('hidden');
        document.body.style.overflow = '';
      }
    });
  })();
</script>

<!-- Loading Screen -->
<div id="loading-screen" class="loading-screen hidden">
  <div class="loading-content">
    <div class="logo-container">
      <img 
        src="/synaptik-logo.png" 
        alt="Synaptik Core" 
        class="loading-logo"
      />
    </div>
  </div>
</div>

<script>
  // Handle external link transitions with loading screen
  function setupExternalLinks() {
    const externalLinks = document.querySelectorAll('a[data-external="true"]');
    const loadingScreen = document.getElementById('loading-screen');
    
    externalLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const href = (e.currentTarget as HTMLAnchorElement).href;
        
        // Show loading screen
        if (loadingScreen) {
          loadingScreen.classList.remove('hidden');
          loadingScreen.classList.add('active');
        }
        
        // Navigate after a brief delay
        setTimeout(() => {
          window.location.href = href;
        }, 900);
      });
    });
  }

  // Run on initial load
  setupExternalLinks();

  // Re-run after view transitions
  document.addEventListener('astro:page-load', setupExternalLinks);
</script>

<style>
  .external-link {
    position: relative;
  }

  .external-link::after {
    content: 'â†—';
    display: inline-block;
    margin-left: 0.25rem;
    font-size: 0.75em;
    opacity: 0.6;
  }

  /* Loading Screen Styles */
  .loading-screen {
    position: fixed;
    inset: 0;
    z-index: 100;
    background-color: #fafaf9; /* stone-50 */
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.7s ease-in-out;
  }

  .loading-screen.active {
    opacity: 1;
    pointer-events: all;
  }

  .loading-screen.hidden {
    display: none;
  }

  .loading-content {
    text-align: center;
  }

  .logo-container {
    animation: logoEntry 0.6s ease-out forwards;
  }

  .loading-logo {
    width: 8rem;
    height: 8rem;
    object-fit: contain;
    animation: logoPulse 2s ease-in-out infinite;
  }

  @keyframes logoEntry {
    from {
      transform: scale(0.5) rotate(-180deg);
      opacity: 0;
    }
    50% {
      transform: scale(1.1) rotate(0deg);
    }
    to {
      transform: scale(1) rotate(0deg);
      opacity: 1;
    }
  }

  @keyframes logoPulse {
    0%, 100% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.05);
    }
  }
</style>
